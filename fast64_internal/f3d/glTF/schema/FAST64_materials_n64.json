{
    "$schema": "http://json-schema.org/draft-04/schema",
    "title": "FAST64_materials_n64 glTF Material Extension",
    "type": "object",
    "description": "glTF extension that provides a representation of fast64 basic n64 material data. With extensions for microcodes.",
    "allOf": [
        {
            "$ref": "glTFProperty.schema.json"
        }
    ],
    "properties": {
        "combiner": {
            "type": "object",
            "description": "The n64 color combiner inputs",
            "properties": {
                "set": {
                    "type": "boolean",
                    "description": "When toggled the material should update the combiner inputs"
                },
                "cycles": {
                    "type": "array",
                    "minItems": 1,
                    "maxItems": 2,
                    "description": "Can have one or two cycles depending on cycleType.",
                    "items": {
                        "type": "object",
                        "properties": {
                            "color": {
                                "type": "array",
                                "minItems": 4,
                                "maxItems": 4,
                                "prefixItems": [
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "COMBINED",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "1",
                                            "NOISE",
                                            "0"
                                        ]
                                    },
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "COMBINED",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "CENTER",
                                            "K4",
                                            "0"
                                        ]
                                    },
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "COMBINED",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "SCALE",
                                            "COMBINED_ALPHA",
                                            "TEXEL0_ALPHA",
                                            "TEXEL1_ALPHA",
                                            "PRIMITIVE_ALPHA",
                                            "SHADE_ALPHA",
                                            "ENV_ALPHA",
                                            "LOD_FRACTION",
                                            "PRIM_LOD_FRAC",
                                            "K5",
                                            "0"
                                        ]
                                    },
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "COMBINED",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "1",
                                            "0"
                                        ]
                                    }
                                ]
                            },
                            "alpha": {
                                "type": "array",
                                "minItems": 4,
                                "maxItems": 4,
                                "prefixItems": [
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "COMBINED",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "1",
                                            "0"
                                        ]
                                    },
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "COMBINED",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "1",
                                            "0"
                                        ]
                                    },
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "LOD_FRACTION",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "PRIM_LOD_FRAC",
                                            "0"
                                        ]
                                    },
                                    {
                                        "type": "string",
                                        "default": "0",
                                        "enum": [
                                            "COMBINED",
                                            "TEXEL0",
                                            "TEXEL1",
                                            "PRIMITIVE",
                                            "SHADE",
                                            "ENVIRONMENT",
                                            "1",
                                            "0"
                                        ]
                                    }
                                ]
                            }
                        }
                    }
                }
            }
        },
        "environment": {
            "type": "object",
            "description": "The environment color, available in the combiner as the color inputs ENVIRONMENT and ENV_ALPHA",
            "properties": {
                "set": {
                    "type": "boolean",
                    "description": "When toggled the material should update the current environment color"
                },
                "color": {
                    "$ref": "color.schema.json"
                }
            }
        },
        "primitive": {
            "type": "object",
            "description": "The primitive color values, available in the combiner as the color inputs PRIMITIVE, PRIMITIVE_ALPHA and PRIM_LOD_FRAC",
            "properties": {
                "set": {
                    "type": "boolean",
                    "description": "When toggled the material should update the current primitive color"
                },
                "color": {
                    "$ref": "color.schema.json"
                },
                "minLoDRatio": {
                    "type": "number",
                    "minimum": 0.0,
                    "maximum": 1.0
                },
                "loDFraction": {
                    "type": "number",
                    "minimum": 0.0,
                    "maximum": 1.0
                }
            }
        },
        "chromaKey": {
            "type": "object",
            "description": "The chroma key values, available in the combiner as the color inputs CENTER and SCALE",
            "properties": {
                "set": {
                    "type": "boolean",
                    "description": "When toggled the material should update the chroma key values and set the h othermode for chroma keying (G_MDSFT_COMBKEY)"
                },
                "center": {
                    "description": "Defines the color intensity at which the key is active.",
                    "$ref": "solid_color.schema.json"
                },
                "scale": {
                    "type": "array",
                    "description": "For hard edge keying, set scale to maximum",
                    "items": {
                        "type": "number",
                        "minimum": 0.0,
                        "maximum": 1.0
                    },
                    "minItems": 3,
                    "maxItems": 3,
                    "default": [
                        0.0,
                        0.0,
                        0.0
                    ]
                },
                "width": {
                    "type": "array",
                    "description": "Size of half the key window. If width > 255, then keying is disabled for that channel",
                    "items": {
                        "type": "number",
                        "minimum": 0.0,
                        "maximum": 16.0
                    },
                    "minItems": 3,
                    "maxItems": 3,
                    "default": [
                        0.0,
                        0.0,
                        0.0
                    ]
                }
            }
        },
        "yuvConvert": {
            "type": "object",
            "description": "The yuv to rgb coefficients, available in the combiner as the color inputs K4 and K5",
            "properties": {
                "set": {
                    "type": "boolean",
                    "description": "When toggled the material should update the yuv to rgb coefficients and set the h othermode for texture conversion (G_TC_FILTCONV)"
                },
                "values": {
                    "type": "array",
                    "minItems": 6,
                    "maxItems": 6,
                    "items": {
                        "type": "number",
                        "minimum": -1.0,
                        "maximum": 1.0
                    },
                    "default": [
                        0.6863,
                        -0.1686,
                        -0.3490,
                        0.8706,
                        0.4475,
                        0.1647
                    ]
                }
            }
        },
        "fog": {
            "type": "object",
            "description": "The fog color and range",
            "properties": {
                "set": {
                    "type": "boolean",
                    "description": "When toggled the material should update the fog color and position"
                },
                "color": {
                    "$ref": "color.schema.json"
                },
                "range": {
                    "type": "array",
                    "items": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 65536
                    },
                    "minItems": 2,
                    "maxItems": 2,
                    "default": [
                        985,
                        1000
                    ]
                }
            }
        },
        "blend": {
            "type": "object",
            "description": "The blend color, used in the blenderer as the input G_BL_CLR_BL",
            "properties": {
                "set": {
                    "type": "boolean",
                    "description": "When toggled the material should update the current blend color"
                },
                "color": {
                    "$ref": "color.schema.json"
                }
            }
        },
        "otherModes": {
            "type": "object",
            "properties": {
                "alphaDither": {
                    "type": "string",
                    "description": "Applies your choice dithering type to output framebuffer alpha. Dithering is used to convert high precision source colors into lower precision framebuffer values",
                    "default": "DISABLE",
                    "enum": [
                        "PATTERN",
                        "NOTPATTERN",
                        "NOISE",
                        "DISABLE"
                    ]
                },
                "colorDither": {
                    "type": "string",
                    "description": "Applies your choice dithering type to output framebuffer color. Dithering is used to convert high precision source colors into lower precision framebuffer values",
                    "default": "MAGICSQ",
                    "enum": [
                        "MAGICSQ",
                        "BAYER",
                        "NOISE",
                        "DISABLE",
                        "ENABLE"
                    ]
                },
                "chromaKey": {
                    "type": "string",
                    "description": "Turns on/off the chroma key. Chroma key requires a special setup to work properly",
                    "default": "NONE",
                    "enum": [
                        "NONE",
                        "KEY"
                    ]
                },
                "textureConvert": {
                    "type": "string",
                    "description": "Sets the function of the texture convert unit, to do texture filtering, YUV to RGB conversion, or both",
                    "default": "CONV",
                    "enum": [
                        "CONV",
                        "FILTCONV",
                        "FILT"
                    ]
                },
                "textureFilter": {
                    "type": "string",
                    "description": "Applies your choice of filtering to texels",
                    "default": "POINT",
                    "enum": [
                        "POINT",
                        "AVERAGE",
                        "BILERP"
                    ]
                },
                "textureLoD": {
                    "type": "string",
                    "description": "Turns on/off the use of LoD on textures. LoD textures change the used tile based on the texel/pixel ratio",
                    "default": "TILE",
                    "enum": [
                        "TILE",
                        "LOD"
                    ]
                },
                "textureLUT": {
                    "type": "string",
                    "description": "Changes texture look up table (LUT) behavior. This property is auto set by fast64",
                    "default": "NONE",
                    "enum": [
                        "NONE",
                        "RGBA16",
                        "IA16"
                    ]
                },
                "textureDetail": {
                    "type": "string",
                    "description": "Changes type of LoD usage. Affects how tiles are selected based on texel magnification. Only works when G_TL_LOD is selected",
                    "default": "CLAMP",
                    "enum": [
                        "CLAMP",
                        "SHARPEN",
                        "DETAIL"
                    ]
                },
                "perspectiveCorrection": {
                    "type": "string",
                    "description": "Turns on/off texture perspective correction",
                    "default": "NONE",
                    "enum": [
                        "NONE",
                        "PERSP"
                    ]
                },
                "cycleType": {
                    "type": "string",
                    "description": "Changes RDP pipeline configuration. For normal textured triangles use one or two cycle mode",
                    "default": "1CYCLE",
                    "enum": [
                        "1CYCLE",
                        "2CYCLES",
                        "COPY",
                        "FILL"
                    ]
                },
                "pipelineMode": {
                    "type": "string",
                    "description": "Changes primitive rasterization timing by adding syncs after tri draws.",
                    "default": "1PASS",
                    "enum": [
                        "1PRIMITIVE",
                        "NPRIMITIVE"
                    ]
                },
                "alphaCompare": {
                    "type": "string",
                    "enum": [
                        "NONE",
                        "THRESHOLD",
                        "DITHER"
                    ],
                    "default": "NONE"
                },
                "zSourceSelection": {
                    "type": "string",
                    "enum": [
                        "PIXEL",
                        "PRIM"
                    ],
                    "default": "PIXEL"
                },
                "renderMode": {
                    "type": "object",
                    "properties": {
                        "presets": {
                            "type": "array",
                            "minItems": 1,
                            "maxItems": 2,
                            "description": "Can have one or two preset combos depending on cycleType.",
                            "items": {
                                "type": "string"
                            }
                        },
                        "flags": {
                            "type": "object",
                            "properties": {
                                "aa": {
                                    "type": "boolean",
                                    "description": "Enables anti-aliasing to rasterized primitive edges. Uses coverage to determine edges",
                                    "default": false
                                },
                                "zTest": {
                                    "type": "boolean",
                                    "description": "Checks pixel Z value against Z-Buffer to test writing",
                                    "default": false
                                },
                                "zWrite": {
                                    "type": "boolean",
                                    "description": "Updates the Z-Buffer with the most recently written pixel Z value",
                                    "default": false
                                },
                                "colorOnCvg": {
                                    "type": "boolean",
                                    "description": "Only draw on coverage (amount primitive covers target pixel) overflow",
                                    "default": false
                                },
                                "alphaOnCvg": {
                                    "type": "boolean",
                                    "description": "Use coverage (amount primitive covers target pixel) as alpha instead of color combiner alpha",
                                    "default": false
                                },
                                "mulCvgXAlpha": {
                                    "type": "boolean",
                                    "description": "Multiply coverage (amount primitive covers target pixel) with alpha and store result as coverage",
                                    "default": false
                                },
                                "forceBlend": {
                                    "type": "boolean",
                                    "description": "Always uses blending on. Default blending is conditionally only applied during partial coverage. Forcing blending will disable division step of the blender, so B input must be 1-A or there may be rendering issues. Always use this option when Z Buffering is off",
                                    "default": false
                                },
                                "readFB": {
                                    "type": "boolean",
                                    "description": "Enables reading from framebuffer for blending calculations",
                                    "default": false
                                },
                                "cvgDst": {
                                    "type": "string",
                                    "description": "Changes how coverage (amount primitive covers target pixel) gets retrieved/stored",
                                    "enum": [
                                        "CLAMP",
                                        "WRAP",
                                        "FULL",
                                        "SAVE"
                                    ],
                                    "default": "CLAMP"
                                },
                                "zMode": {
                                    "type": "boolean",
                                    "description": "Changes Z calculation for different types of primitives",
                                    "enum": [
                                        "OPA",
                                        "INTER",
                                        "XLU",
                                        "DEC"
                                    ],
                                    "default": "OPA"
                                }
                            }
                        },
                        "blender": {
                            "type": "array",
                            "minItems": 1,
                            "maxItems": 2,
                            "description": "Can have one or two cycles depending on cycleType.",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "color": {
                                        "type": "array",
                                        "minItems": 2,
                                        "maxItems": 2,
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "IN",
                                                "MEM",
                                                "BL",
                                                "FOG"
                                            ]
                                        }
                                    },
                                    "alpha": {
                                        "type": "array",
                                        "minItems": 2,
                                        "maxItems": 2,
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "A_IN",
                                                "A_FOG",
                                                "A_SHADE",
                                                "0"
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "primDepth": {
            "properties": {
                "z": {
                    "type": "integer",
                    "description": "The value to use for z is the screen Z position of the object you are rendering. This is a value ranging from 0x0000 to 0x7fff, where 0x0000 usually corresponds to the near clipping plane and 0x7fff usually corresponds to the far clipping plane. You can use -1 to force Z to be at the far clipping plane.",
                    "default": 0,
                    "minimum": -1,
                    "maximum": 32767
                },
                "dz": {
                    "type": "integer",
                    "description": "The dz value should be set to 0. This value is used for antialiasing and objects drawn in decal render mode and must always be a power of 2 (0, 1, 2, 4, 8, ... 0x4000). If you are using decal mode and part of the decaled object is not being rendered correctly, try setting this to powers of 2. Otherwise use 0.",
                    "default": 0,
                    "minimum": 0,
                    "maximum": 16384
                }
            }
        },
        "mipmapCount": {
            "type": "integer",
            "minimum": 2,
            "maximum": 8,
            "default": 2
        },
        "textures": {
            "type": "object",
            "description": "Dict of texture info objects for each tile, could support up to 8 tiles in the future",
            "minItems": 0,
            "maxItems": 2,
            "additionalProperties": {
                "allOf": [
                    {
                        "$ref": "textureInfo.schema.json"
                    }
                ]
            }
        },
        "textureScale": {
            "type": "array",
            "minItems": 2,
            "maxItems": 2,
            "items": {
                "type": "number"
            },
            "default": [
                1,
                1
            ]
        },
        "uvBasis": {
            "type": "integer",
            "default": 0,
            "minimum": 0,
            "maximum": 1
        },
        "large": {
            "type": "object",
            "description": "Settings for large textures, if property exists large texture mode is being used",
            "properties": {
                "edges": {
                    "type": "string",
                    "description": "Clamp outside image bounds or wrap outside image bounds (more expensive)",
                    "enum": [
                        "CLAMP",
                        "WRAP"
                    ],
                    "default": "CLAMP"
                }
            }
        },
        "extensions": {
            "type": "object",
            "properties": {
                "FAST64_materials_f3d": {
                    "$ref": "FAST64_materials_f3d.schema.json"
                }
            }
        }
    },
    "additionalProperties": false
}